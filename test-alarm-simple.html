<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>告警数据简单测试</title>
</head>
<body>
    <h1>告警数据测试</h1>
    <div id="output" style="white-space: pre; font-family: monospace; background: #f5f5f5; padding: 20px;"></div>

    <script src="common.js"></script>
    <script>
        const output = document.getElementById('output');

        function log(msg) {
            output.textContent += msg + '\n';
            console.log(msg);
        }

        log('=== 开始测试 ===');
        log('translations 是否存在: ' + (typeof translations !== 'undefined'));

        if (typeof translations !== 'undefined') {
            log('translations.zh 存在: ' + !!translations.zh);
            log('translations.en 存在: ' + !!translations.en);

            // 测试翻译函数
            function getTranslation(key) {
                const lang = localStorage.getItem('language') || 'zh';
                if (typeof translations !== 'undefined' && translations[lang]) {
                    return translations[lang][key] || key;
                }
                return key;
            }

            log('\n=== 测试站点名称翻译 ===');
            log('siteNameTech: "' + getTranslation('siteNameTech') + '"');
            log('siteNameIndustrial: "' + getTranslation('siteNameIndustrial') + '"');

            log('\n=== 生成站点数组 ===');
            const sites = [
                { id: 'site1', name: getTranslation('siteNameTech') },
                { id: 'site2', name: getTranslation('siteNameIndustrial') },
                { id: 'site3', name: getTranslation('siteNameCommerce') },
                { id: 'site4', name: getTranslation('siteNameLogistics') },
                { id: 'site5', name: getTranslation('siteNameRD') },
                { id: 'site6', name: getTranslation('siteNameDataCenter') }
            ];

            log('站点数量: ' + sites.length);
            sites.forEach((site, index) => {
                log(`  ${index + 1}. ${site.id}: "${site.name}"`);
            });

            log('\n=== 生成模拟告警数据 ===');
            const mockAlarms = [];
            sites.forEach(site => {
                mockAlarms.push({
                    site: site.name,
                    device: '储能柜#1',
                    type: '电池过温'
                });
            });

            log('生成的告警数量: ' + mockAlarms.length);
            mockAlarms.slice(0, 3).forEach((alarm, index) => {
                log(`  ${index + 1}. 站点: "${alarm.site}", 设备: ${alarm.device}`);
            });

        } else {
            log('❌ ERROR: translations 对象不存在!');
            log('可能原因: common.js 未加载或加载失败');
        }
    </script>
</body>
</html>
